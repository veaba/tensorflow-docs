(window.webpackJsonp=window.webpackJsonp||[]).push([[677],{865:function(e,s,t){"use strict";t.r(s);var a=t(0),o=Object(a.a)({},(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("p",[e._v("Computes a weighted cross entropy. (deprecated arguments)")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v(" tf.compat.v1.nn.weighted_cross_entropy_with_logits(\n    labels=None,\n    logits=None,\n    pos_weight=None,\n    name=None,\n    targets=None\n)\n")])])]),t("p",[e._v("This is like sigmoid_cross_entropy_with_logits() except that pos_weight, allows one to trade off recall and precision by up- or down-weighting the cost of a positive error relative to a negative error.")]),e._v(" "),t("p",[e._v("The usual cross-entropy cost is defined as:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v(" labels * -log(sigmoid(logits)) +\n    (1 - labels) * -log(1 - sigmoid(logits))\n")])])]),t("p",[e._v("A value pos_weight > 1 decreases the false negative count, hence increasing the recall. Conversely setting pos_weight < 1 decreases the false positive count and increases the precision. This can be seen from the fact that pos_weight is introduced as a multiplicative coefficient for the positive labels term in the loss expression:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v(" labels * -log(sigmoid(logits)) * pos_weight +\n    (1 - labels) * -log(1 - sigmoid(logits))\n")])])]),t("p",[e._v("For brevity, let x = logits, z = labels, q = pos_weight. The loss is:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("   qz * -log(sigmoid(x)) + (1 - z) * -log(1 - sigmoid(x))\n= qz * -log(1 / (1 + exp(-x))) + (1 - z) * -log(exp(-x) / (1 + exp(-x)))\n= qz * log(1 + exp(-x)) + (1 - z) * (-log(exp(-x)) + log(1 + exp(-x)))\n= qz * log(1 + exp(-x)) + (1 - z) * (x + log(1 + exp(-x))\n= (1 - z) * x + (qz +  1 - z) * log(1 + exp(-x))\n= (1 - z) * x + (1 + (q - 1) * z) * log(1 + exp(-x))\n")])])]),t("p",[e._v("Setting l = (1 + (q - 1) * z), to ensure stability and avoid overflow, the implementation uses")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v(" (1 - z) * x + l * (log(1 + exp(-abs(x))) + max(-x, 0))\n")])])]),t("p",[e._v("logits and labels must have the same type and shape.")]),e._v(" "),t("h4",{attrs:{id:"args"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#args","aria-hidden":"true"}},[e._v("#")]),e._v(" Args:")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("labels")]),e._v(": A "),t("code",[e._v("Tensor")]),e._v(" of the same type and shape as "),t("code",[e._v("logits")]),e._v(".")]),e._v(" "),t("li",[t("code",[e._v("logits")]),e._v(": A "),t("code",[e._v("Tensor")]),e._v(" of type "),t("code",[e._v("float32")]),e._v(" or "),t("code",[e._v("float64")]),e._v(".")]),e._v(" "),t("li",[t("code",[e._v("pos_weight")]),e._v(": A coefficient to use on the positive examples.")]),e._v(" "),t("li",[t("code",[e._v("name")]),e._v(": A "),t("code",[e._v("name")]),e._v(" for the operation (optional).")]),e._v(" "),t("li",[t("code",[e._v("targets")]),e._v(": Deprecated alias for "),t("code",[e._v("labels")]),e._v(".")])]),e._v(" "),t("h4",{attrs:{id:"returns"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#returns","aria-hidden":"true"}},[e._v("#")]),e._v(" Returns:")]),e._v(" "),t("p",[e._v("A Tensor of the same shape as logits with the componentwise weighted logistic losses.")]),e._v(" "),t("h4",{attrs:{id:"raises"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#raises","aria-hidden":"true"}},[e._v("#")]),e._v(" Raises:")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("ValueError")]),e._v(": If "),t("code",[e._v("logits")]),e._v(" and "),t("code",[e._v("labels")]),e._v(" do not have the same shape.")])])])}),[],!1,null,null,null);s.default=o.exports}}]);