(window.webpackJsonp=window.webpackJsonp||[]).push([[1096],{1285:function(e,t,o){"use strict";o.r(t);var a=o(0),r=Object(a.a)({},(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[o("h2",{attrs:{id:"class-checkpointinputpipelinehook"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#class-checkpointinputpipelinehook","aria-hidden":"true"}},[e._v("#")]),e._v(" Class CheckpointInputPipelineHook")]),e._v(" "),o("p",[e._v("Checkpoints input pipeline state every N steps or seconds.\n"),o("a",{attrs:{href:"https://www.tensorflow.org/api_docs/python/tf/estimator/SessionRunHook",target:"_blank",rel:"noopener noreferrer"}},[e._v("SessionRunHook"),o("OutboundLink")],1),e._v("Inherits From:")]),e._v(" "),o("h3",{attrs:{id:"aliases"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#aliases","aria-hidden":"true"}},[e._v("#")]),e._v(" Aliases:")]),e._v(" "),o("ul",[o("li",[e._v("Class "),o("code",[e._v("tf.compat.v1.data.experimental.CheckpointInputPipelineHook")])]),e._v(" "),o("li",[e._v("Class "),o("code",[e._v("tf.compat.v2.data.experimental.CheckpointInputPipelineHook")])])]),e._v(" "),o("p",[e._v("This hook saves the state of the iterators in the Graph so that when training is resumed the input pipeline continues from where it left off. This could potentially avoid overfitting in certain pipelines where the number of training steps per eval are small compared to the dataset size or if the training pipeline is pre-empted.")]),e._v(" "),o("p",[e._v('Differences from CheckpointSaverHook: 1. Saves only the input pipelines in the "iterators" collection and not the global variables or other saveable objects. 2. Does not write the GraphDef and MetaGraphDef to the summary.')]),e._v(" "),o("p",[e._v("Example of checkpointing the training pipeline:")]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v(" est = tf.estimator.Estimator(model_fn)\nwhile True:\n  est.train(\n      train_input_fn,\n      hooks=[tf.data.experimental.CheckpointInputPipelineHook(est)],\n      steps=train_steps_per_eval)\n  # Note: We do not pass the hook here.\n  metrics = est.evaluate(eval_input_fn)\n  if should_stop_the_training(metrics):\n    break\n")])])]),o("p",[e._v("This hook should be used if the input pipeline state needs to be saved separate from the model checkpoint. Doing so may be useful for a few reasons: 1. The input pipeline checkpoint may be large, if there are large shuffle or prefetch buffers for instance, and may bloat the checkpoint size. 2. If the input pipeline is shared between training and validation, restoring the checkpoint during validation may override the validation input pipeline.\n"),o("a",{attrs:{href:"https://www.tensorflow.org/api_docs/python/tf/data/experimental/make_saveable_from_iterator",target:"_blank",rel:"noopener noreferrer"}},[e._v("tf.data.experimental.make_saveable_from_iterator"),o("OutboundLink")],1),e._v("For saving the input pipeline checkpoint alongside the model weights use  directly to create a SaveableObject and add to the SAVEABLE_OBJECTS collection. Note, however, that you will need to be careful not to restore the training iterator during eval. You can do that by not adding the iterator to the SAVEABLE_OBJECTS collector when building the eval graph.")]),e._v(" "),o("h2",{attrs:{id:"init"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#init","aria-hidden":"true"}},[e._v("#")]),e._v(" "),o("strong",[e._v("init")])]),e._v(" "),o("p",[o("a",{attrs:{href:"https://github.com/tensorflow/tensorflow/blob/r2.0/tensorflow/python/data/experimental/ops/iterator_ops.py#L138-L184",target:"_blank",rel:"noopener noreferrer"}},[e._v("View source"),o("OutboundLink")],1)]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v(" __init__(estimator)\n")])])]),o("p",[e._v("Initializes a CheckpointInputPipelineHook.")]),e._v(" "),o("h4",{attrs:{id:"args"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#args","aria-hidden":"true"}},[e._v("#")]),e._v(" Args:")]),e._v(" "),o("ul",[o("li",[o("code",[e._v("estimator")]),e._v(": Estimator.")])]),e._v(" "),o("h4",{attrs:{id:"raises"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#raises","aria-hidden":"true"}},[e._v("#")]),e._v(" Raises:")]),e._v(" "),o("ul",[o("li",[o("code",[e._v("ValueError")]),e._v(": One of "),o("code",[e._v("save_steps")]),e._v(" or "),o("code",[e._v("save_secs")]),e._v(" should be set.")]),e._v(" "),o("li",[o("code",[e._v("ValueError")]),e._v(": At most one of saver or scaffold should be set.")])]),e._v(" "),o("h2",{attrs:{id:"methods"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#methods","aria-hidden":"true"}},[e._v("#")]),e._v(" Methods")]),e._v(" "),o("h3",{attrs:{id:"after-create-session"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#after-create-session","aria-hidden":"true"}},[e._v("#")]),e._v(" after_create_session")]),e._v(" "),o("p",[o("a",{attrs:{href:"https://github.com/tensorflow/tensorflow/blob/r2.0/tensorflow/python/training/session_run_hook.py#L112-L127",target:"_blank",rel:"noopener noreferrer"}},[e._v("View source"),o("OutboundLink")],1)]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v(" after_create_session(\n    session,\n    coord\n)\n")])])]),o("p",[e._v("Called when new TensorFlow session is created.")]),e._v(" "),o("p",[e._v("This is called to signal the hooks that a new session has been created. This has two essential differences with the situation in which begin is called:")]),e._v(" "),o("ul",[o("li",[o("code",[e._v("W")]),e._v("h"),o("code",[e._v("e")]),e._v("n"),o("code"),e._v("t"),o("code",[e._v("h")]),e._v("i"),o("code",[e._v("s")]),e._v(" "),o("code",[e._v("i")]),e._v("s"),o("code"),e._v("c"),o("code",[e._v("a")]),e._v("l"),o("code",[e._v("l")]),e._v("e"),o("code",[e._v("d")]),e._v(","),o("code"),e._v("t"),o("code",[e._v("h")]),e._v("e"),o("code"),e._v("g"),o("code",[e._v("r")]),e._v("a"),o("code",[e._v("p")]),e._v("h"),o("code"),e._v("i"),o("code",[e._v("s")]),e._v(" "),o("code",[e._v("f")]),e._v("i"),o("code",[e._v("n")]),e._v("a"),o("code",[e._v("l")]),e._v("i"),o("code",[e._v("z")]),e._v("e"),o("code",[e._v("d")]),e._v(" "),o("code",[e._v("a")]),e._v("n"),o("code",[e._v("d")]),e._v(" "),o("code",[e._v("o")]),e._v("p"),o("code",[e._v("s")]),e._v(" "),o("code",[e._v("c")]),e._v("a"),o("code",[e._v("n")]),e._v(" "),o("code",[e._v("n")]),e._v("o"),o("code"),e._v("l"),o("code",[e._v("o")]),e._v("n"),o("code",[e._v("g")]),e._v("e"),o("code",[e._v("r")]),e._v(" "),o("code",[e._v("b")]),e._v("e"),o("code"),e._v("a"),o("code",[e._v("d")]),e._v("d"),o("code",[e._v("e")]),e._v("d"),o("code"),e._v("t"),o("code",[e._v("o")]),e._v(" "),o("code",[e._v("t")]),e._v("h"),o("code",[e._v("e")]),e._v(" "),o("code",[e._v("g")]),e._v("r"),o("code",[e._v("a")]),e._v("p"),o("code",[e._v("h")]),e._v(".``")]),e._v(" "),o("li",[o("code",[e._v("T")]),e._v("h"),o("code",[e._v("i")]),e._v("s"),o("code"),e._v("m"),o("code",[e._v("e")]),e._v("t"),o("code",[e._v("h")]),e._v("o"),o("code",[e._v("d")]),e._v(" "),o("code",[e._v("w")]),e._v("i"),o("code",[e._v("l")]),e._v("l"),o("code"),e._v("a"),o("code",[e._v("l")]),e._v("s"),o("code",[e._v("o")]),e._v(" "),o("code",[e._v("b")]),e._v("e"),o("code"),e._v("c"),o("code",[e._v("a")]),e._v("l"),o("code",[e._v("l")]),e._v("e"),o("code",[e._v("d")]),e._v(" "),o("code",[e._v("a")]),e._v("s"),o("code"),e._v("a"),o("code"),e._v("r"),o("code",[e._v("e")]),e._v("s"),o("code",[e._v("u")]),e._v("l"),o("code",[e._v("t")]),e._v(" "),o("code",[e._v("o")]),e._v("f"),o("code"),e._v("r"),o("code",[e._v("e")]),e._v("c"),o("code",[e._v("o")]),e._v("v"),o("code",[e._v("e")]),e._v("r"),o("code",[e._v("i")]),e._v("n"),o("code",[e._v("g")]),e._v(" "),o("code",[e._v("a")]),e._v(" "),o("code",[e._v("w")]),e._v("r"),o("code",[e._v("a")]),e._v("p"),o("code",[e._v("p")]),e._v("e"),o("code",[e._v("d")]),e._v(" "),o("code",[e._v("s")]),e._v("e"),o("code",[e._v("s")]),e._v("s"),o("code",[e._v("i")]),e._v("o"),o("code",[e._v("n")]),e._v(","),o("code"),e._v("n"),o("code",[e._v("o")]),e._v("t"),o("code"),e._v("o"),o("code",[e._v("n")]),e._v("l"),o("code",[e._v("y")]),e._v(" "),o("code",[e._v("a")]),e._v("t"),o("code"),e._v("t"),o("code",[e._v("h")]),e._v("e"),o("code"),e._v("b"),o("code",[e._v("e")]),e._v("g"),o("code",[e._v("i")]),e._v("n"),o("code",[e._v("n")]),e._v("i"),o("code",[e._v("n")]),e._v("g"),o("code"),e._v("o"),o("code",[e._v("f")]),e._v(" "),o("code",[e._v("t")]),e._v("h"),o("code",[e._v("e")]),e._v(" "),o("code",[e._v("o")]),e._v("v"),o("code",[e._v("e")]),e._v("r"),o("code",[e._v("a")]),e._v("l"),o("code",[e._v("l")]),e._v(" "),o("code",[e._v("s")]),e._v("e"),o("code",[e._v("s")]),e._v("s"),o("code",[e._v("i")]),e._v("o"),o("code",[e._v("n")]),e._v(".``")])]),e._v(" "),o("h4",{attrs:{id:"args-2"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#args-2","aria-hidden":"true"}},[e._v("#")]),e._v(" Args:")]),e._v(" "),o("ul",[o("li",[o("code",[e._v("session")]),e._v(": A TensorFlow Session that has been created.")]),e._v(" "),o("li",[o("code",[e._v("coord")]),e._v(": A Coordinator object which keeps track of all threads.")])]),e._v(" "),o("h3",{attrs:{id:"after-run"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#after-run","aria-hidden":"true"}},[e._v("#")]),e._v(" after_run")]),e._v(" "),o("p",[o("a",{attrs:{href:"https://github.com/tensorflow/tensorflow/blob/r2.0/tensorflow/python/data/experimental/ops/iterator_ops.py#L240-L241",target:"_blank",rel:"noopener noreferrer"}},[e._v("View source"),o("OutboundLink")],1)]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v(" after_run(\n    run_context,\n    run_values\n)\n")])])]),o("p",[e._v("Called after each call to run().")]),e._v(" "),o("p",[e._v("The run_values argument contains results of requested ops/tensors by before_run().")]),e._v(" "),o("p",[e._v("The run_context argument is the same one send to before_run call. run_context.request_stop() can be called to stop the iteration.")]),e._v(" "),o("p",[e._v("If session.run() raises any exceptions then after_run() is not called.")]),e._v(" "),o("h4",{attrs:{id:"args-3"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#args-3","aria-hidden":"true"}},[e._v("#")]),e._v(" Args:")]),e._v(" "),o("ul",[o("li",[o("code",[e._v("run_context")]),e._v(": A "),o("code",[e._v("SessionRunContext")]),e._v(" object.")]),e._v(" "),o("li",[o("code",[e._v("run_values")]),e._v(": A SessionRunValues object.")])]),e._v(" "),o("h3",{attrs:{id:"before-run"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#before-run","aria-hidden":"true"}},[e._v("#")]),e._v(" before_run")]),e._v(" "),o("p",[o("a",{attrs:{href:"https://github.com/tensorflow/tensorflow/blob/r2.0/tensorflow/python/data/experimental/ops/iterator_ops.py#L234-L238",target:"_blank",rel:"noopener noreferrer"}},[e._v("View source"),o("OutboundLink")],1)]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v(" before_run(run_context)\n")])])]),o("p",[e._v("Called before each call to run().")]),e._v(" "),o("p",[e._v("You can return from this call a SessionRunArgs object indicating ops or tensors to add to the upcoming run() call. These ops/tensors will be run together with the ops/tensors originally passed to the original run() call. The run args you return can also contain feeds to be added to the run() call.")]),e._v(" "),o("p",[e._v("The run_context argument is a SessionRunContext that provides information about the upcoming run() call: the originally requested op/tensors, the TensorFlow Session.")]),e._v(" "),o("p",[e._v("At this point graph is finalized and you can not add ops.")]),e._v(" "),o("h4",{attrs:{id:"args-4"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#args-4","aria-hidden":"true"}},[e._v("#")]),e._v(" Args:")]),e._v(" "),o("ul",[o("li",[o("code",[e._v("run_context")]),e._v(": A "),o("code",[e._v("SessionRunContext")]),e._v(" object.")])]),e._v(" "),o("h4",{attrs:{id:"returns"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#returns","aria-hidden":"true"}},[e._v("#")]),e._v(" Returns:")]),e._v(" "),o("p",[e._v("None or a SessionRunArgs object.")]),e._v(" "),o("h3",{attrs:{id:"begin"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#begin","aria-hidden":"true"}},[e._v("#")]),e._v(" begin")]),e._v(" "),o("p",[o("a",{attrs:{href:"https://github.com/tensorflow/tensorflow/blob/r2.0/tensorflow/python/data/experimental/ops/iterator_ops.py#L186-L197",target:"_blank",rel:"noopener noreferrer"}},[e._v("View source"),o("OutboundLink")],1)]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v(" begin()\n")])])]),o("p",[e._v("Called once before using the session.")]),e._v(" "),o("p",[e._v("When called, the default graph is the one that will be launched in the session. The hook can modify the graph by adding new operations to it. After the begin() call the graph will be finalized and the other callbacks can not modify the graph anymore. Second call of begin() on the same graph, should not change the graph.")]),e._v(" "),o("h3",{attrs:{id:"end"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#end","aria-hidden":"true"}},[e._v("#")]),e._v(" end")]),e._v(" "),o("p",[o("a",{attrs:{href:"https://github.com/tensorflow/tensorflow/blob/r2.0/tensorflow/python/data/experimental/ops/iterator_ops.py#L243-L244",target:"_blank",rel:"noopener noreferrer"}},[e._v("View source"),o("OutboundLink")],1)]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v(" end(session)\n")])])]),o("p",[e._v("Called at the end of session.")]),e._v(" "),o("p",[e._v("The session argument can be used in case the hook wants to run final ops, such as saving a last checkpoint.")]),e._v(" "),o("p",[e._v("If session.run() raises exception other than OutOfRangeError or StopIteration then end() is not called. Note the difference between end() and after_run() behavior when session.run() raises OutOfRangeError or StopIteration. In that case end() is called but after_run() is not called.")]),e._v(" "),o("h4",{attrs:{id:"args-5"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#args-5","aria-hidden":"true"}},[e._v("#")]),e._v(" Args:")]),e._v(" "),o("ul",[o("li",[o("code",[e._v("session")]),e._v(": A TensorFlow Session that will be soon closed.")])])])}),[],!1,null,null,null);t.default=r.exports}}]);