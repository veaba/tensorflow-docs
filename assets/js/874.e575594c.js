(window.webpackJsonp=window.webpackJsonp||[]).push([[874],{1062:function(e,t,r){"use strict";r.r(t);var a=r(0),o=Object(a.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h2",{attrs:{id:"class-queuerunner"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#class-queuerunner","aria-hidden":"true"}},[e._v("#")]),e._v(" Class QueueRunner")]),e._v(" "),r("p",[e._v("Holds a list of enqueue operations for a queue, each to be run in a thread.")]),e._v(" "),r("h3",{attrs:{id:"aliases"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#aliases","aria-hidden":"true"}},[e._v("#")]),e._v(" Aliases:")]),e._v(" "),r("ul",[r("li",[e._v("Class "),r("code",[e._v("tf.compat.v1.train.queue_runner.QueueRunner")])])]),e._v(" "),r("p",[e._v("Queues are a convenient TensorFlow mechanism to compute tensors asynchronously using multiple threads. For example in the canonical 'Input Reader' setup one set of threads generates filenames in a queue; a second set of threads read records from the files, processes them, and enqueues tensors on a second queue; a third set of threads dequeues these input records to construct batches and runs them through training operations.")]),e._v(" "),r("p",[e._v("There are several delicate issues when running multiple threads that way: closing the queues in sequence as the input is exhausted, correctly catching and reporting exceptions, etc.")]),e._v(" "),r("p",[e._v("The QueueRunner, combined with the Coordinator, helps handle these issues.")]),e._v(" "),r("h4",{attrs:{id:"eager-compatibility"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#eager-compatibility","aria-hidden":"true"}},[e._v("#")]),e._v(" Eager Compatibility")]),e._v(" "),r("p",[r("a",{attrs:{href:"https://www.tensorflow.org/api_docs/python/tf/data",target:"_blank",rel:"noopener noreferrer"}},[e._v("tf.data"),r("OutboundLink")],1),e._v("QueueRunners are not compatible with eager execution. Instead, please use  to get data into your model.")]),e._v(" "),r("h2",{attrs:{id:"init"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#init","aria-hidden":"true"}},[e._v("#")]),e._v(" "),r("strong",[e._v("init")])]),e._v(" "),r("p",[r("a",{attrs:{href:"https://github.com/tensorflow/tensorflow/blob/r2.0/tensorflow/python/training/queue_runner_impl.py#L60-L118",target:"_blank",rel:"noopener noreferrer"}},[e._v("View source"),r("OutboundLink")],1)]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v(" __init__(\n    queue=None,\n    enqueue_ops=None,\n    close_op=None,\n    cancel_op=None,\n    queue_closed_exception_types=None,\n    queue_runner_def=None,\n    import_scope=None\n)\n")])])]),r("p",[e._v("Create a QueueRunner. (deprecated)")]),e._v(" "),r("p",[e._v("On construction the QueueRunner adds an op to close the queue. That op will be run if the enqueue ops raise exceptions.")]),e._v(" "),r("p",[e._v("When you later call the create_threads() method, the QueueRunner will create one thread for each op in enqueue_ops. Each thread will run its enqueue op in parallel with the other threads. The enqueue ops do not have to all be the same op, but it is expected that they all enqueue tensors in queue.")]),e._v(" "),r("h4",{attrs:{id:"args"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#args","aria-hidden":"true"}},[e._v("#")]),e._v(" Args:")]),e._v(" "),r("ul",[r("li",[r("code",[e._v("queue")]),e._v(": A "),r("code",[e._v("Queue")]),e._v(".")]),e._v(" "),r("li",[r("code",[e._v("enqueue_ops")]),e._v(": List of en"),r("code",[e._v("queue")]),e._v(" ops to run in threads later.")]),e._v(" "),r("li",[r("code",[e._v("close_op")]),e._v(": Op to close the "),r("code",[e._v("queue")]),e._v(". Pending en"),r("code",[e._v("queue")]),e._v(" ops are preserved.")]),e._v(" "),r("li",[r("code",[e._v("cancel_op")]),e._v(": Op to close the "),r("code",[e._v("queue")]),e._v(" and cancel pending en"),r("code",[e._v("queue")]),e._v(" ops.")]),e._v(" "),r("li",[r("code",[e._v("queue")]),e._v("_closed_exception_types: Optional tuple of Exception types that indicate that the "),r("code",[e._v("queue")]),e._v(" has been closed when raised during an en"),r("code",[e._v("queue")]),e._v(" operation. Defaults to ("),r("code",[e._v("tf.errors.OutOfRangeError,")]),e._v("). Another common case includes ("),r("code",[e._v("tf.errors.OutOfRangeError,")]),e._v(" tf.errors.CancelledError), when some of the en"),r("code",[e._v("queue")]),e._v(" ops may de"),r("code",[e._v("queue")]),e._v(" from other "),r("code",[e._v("Queue")]),e._v("s.")]),e._v(" "),r("li",[r("code",[e._v("queue")]),e._v("_runner_def: Optional "),r("code",[e._v("Queue")]),e._v("RunnerDef protocol buffer. If specified, recreates the "),r("code",[e._v("Queue")]),e._v("Runner from its contents. "),r("code",[e._v("queue")]),e._v("_runner_def and the other arguments are mutually exclusive.")]),e._v(" "),r("li",[r("code",[e._v("import_scope")]),e._v(": Optional "),r("code",[e._v("string")]),e._v(". Name scope to add. Only used when initializing from protocol buffer.")])]),e._v(" "),r("h4",{attrs:{id:"raises"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#raises","aria-hidden":"true"}},[e._v("#")]),e._v(" Raises:")]),e._v(" "),r("ul",[r("li",[r("code",[e._v("ValueError")]),e._v(": If both "),r("code",[e._v("queue_runner_def")]),e._v(" and "),r("code",[e._v("queue")]),e._v(" are both specified.")]),e._v(" "),r("li",[r("code",[e._v("ValueError")]),e._v(": If "),r("code",[e._v("queue")]),e._v(" or "),r("code",[e._v("enqueue_ops")]),e._v(" are not provided when not restoring from "),r("code",[e._v("queue_runner_def")]),e._v(".")]),e._v(" "),r("li",[r("code",[e._v("RuntimeError")]),e._v(": If eager execution is enabled.")])]),e._v(" "),r("h2",{attrs:{id:"properties"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#properties","aria-hidden":"true"}},[e._v("#")]),e._v(" Properties")]),e._v(" "),r("h3",{attrs:{id:"cancel-op"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#cancel-op","aria-hidden":"true"}},[e._v("#")]),e._v(" cancel_op")]),e._v(" "),r("h3",{attrs:{id:"close-op"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#close-op","aria-hidden":"true"}},[e._v("#")]),e._v(" close_op")]),e._v(" "),r("h3",{attrs:{id:"enqueue-ops"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#enqueue-ops","aria-hidden":"true"}},[e._v("#")]),e._v(" enqueue_ops")]),e._v(" "),r("h3",{attrs:{id:"exceptions-raised"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#exceptions-raised","aria-hidden":"true"}},[e._v("#")]),e._v(" exceptions_raised")]),e._v(" "),r("p",[e._v("Exceptions raised but not handled by the QueueRunner threads.")]),e._v(" "),r("p",[e._v("Exceptions raised in queue runner threads are handled in one of two ways depending on whether or not a Coordinator was passed to create_threads():")]),e._v(" "),r("ul",[r("li",[e._v("With a "),r("code",[e._v("Coordinator")]),e._v(", exceptions are reported to the coordinator and forgotten by the "),r("code",[e._v("QueueRunner")]),e._v(".")]),e._v(" "),r("li",[e._v("Without a "),r("code",[e._v("Coordinator")]),e._v(", exceptions are captured by the "),r("code",[e._v("QueueRunner")]),e._v(" and made available in this "),r("code",[e._v("exceptions_raised")]),e._v(" property.")])]),e._v(" "),r("h4",{attrs:{id:"returns"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#returns","aria-hidden":"true"}},[e._v("#")]),e._v(" Returns:")]),e._v(" "),r("p",[e._v("A list of Python Exception objects. The list is empty if no exception was captured. (No exceptions are captured when using a Coordinator.)")]),e._v(" "),r("h3",{attrs:{id:"name"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#name","aria-hidden":"true"}},[e._v("#")]),e._v(" name")]),e._v(" "),r("p",[e._v("The string name of the underlying Queue.")]),e._v(" "),r("h3",{attrs:{id:"queue"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#queue","aria-hidden":"true"}},[e._v("#")]),e._v(" queue")]),e._v(" "),r("h3",{attrs:{id:"queue-closed-exception-types"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#queue-closed-exception-types","aria-hidden":"true"}},[e._v("#")]),e._v(" queue_closed_exception_types")]),e._v(" "),r("h2",{attrs:{id:"methods"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#methods","aria-hidden":"true"}},[e._v("#")]),e._v(" Methods")]),e._v(" "),r("h3",{attrs:{id:"create-threads"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#create-threads","aria-hidden":"true"}},[e._v("#")]),e._v(" create_threads")]),e._v(" "),r("p",[r("a",{attrs:{href:"https://github.com/tensorflow/tensorflow/blob/r2.0/tensorflow/python/training/queue_runner_impl.py#L301-L356",target:"_blank",rel:"noopener noreferrer"}},[e._v("View source"),r("OutboundLink")],1)]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v(" create_threads(\n    sess,\n    coord=None,\n    daemon=False,\n    start=False\n)\n")])])]),r("p",[e._v("Create threads to run the enqueue ops for the given session.")]),e._v(" "),r("p",[e._v("This method requires a session in which the graph was launched. It creates a list of threads, optionally starting them. There is one thread for each op passed in enqueue_ops.")]),e._v(" "),r("p",[e._v("The coord argument is an optional coordinator that the threads will use to terminate together and report exceptions. If a coordinator is given, this method starts an additional thread to close the queue when the coordinator requests a stop.")]),e._v(" "),r("p",[e._v("If previously created threads for the given session are still running, no new threads will be created.")]),e._v(" "),r("h4",{attrs:{id:"args-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#args-2","aria-hidden":"true"}},[e._v("#")]),e._v(" Args:")]),e._v(" "),r("ul",[r("li",[r("code",[e._v("sess")]),e._v(": A "),r("code",[e._v("Session")]),e._v(".")]),e._v(" "),r("li",[r("code",[e._v("coord")]),e._v(": Optional "),r("code",[e._v("Coordinator")]),e._v(" object for reporting errors and checking stop conditions.")]),e._v(" "),r("li",[r("code",[e._v("daemon")]),e._v(": Boolean. If "),r("code",[e._v("True")]),e._v(" make the threads "),r("code",[e._v("daemon")]),e._v(" threads.")]),e._v(" "),r("li",[r("code",[e._v("start")]),e._v(": Boolean. If "),r("code",[e._v("True")]),e._v(" "),r("code",[e._v("start")]),e._v("s the threads. If "),r("code",[e._v("False")]),e._v(" the caller must call the "),r("code",[e._v("start")]),e._v("() method of the returned threads.")])]),e._v(" "),r("h4",{attrs:{id:"returns-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#returns-2","aria-hidden":"true"}},[e._v("#")]),e._v(" Returns:")]),e._v(" "),r("p",[e._v("A list of threads.")]),e._v(" "),r("h3",{attrs:{id:"from-proto"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#from-proto","aria-hidden":"true"}},[e._v("#")]),e._v(" from_proto")]),e._v(" "),r("p",[r("a",{attrs:{href:"https://github.com/tensorflow/tensorflow/blob/r2.0/tensorflow/python/training/queue_runner_impl.py#L387-L391",target:"_blank",rel:"noopener noreferrer"}},[e._v("View source"),r("OutboundLink")],1)]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v(" @staticmethod\nfrom_proto(\n    queue_runner_def,\n    import_scope=None\n)\n")])])]),r("p",[e._v("Returns a QueueRunner object created from queue_runner_def.")]),e._v(" "),r("h3",{attrs:{id:"to-proto"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#to-proto","aria-hidden":"true"}},[e._v("#")]),e._v(" to_proto")]),e._v(" "),r("p",[r("a",{attrs:{href:"https://github.com/tensorflow/tensorflow/blob/r2.0/tensorflow/python/training/queue_runner_impl.py#L358-L385",target:"_blank",rel:"noopener noreferrer"}},[e._v("View source"),r("OutboundLink")],1)]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v(" to_proto(export_scope=None)\n")])])]),r("p",[e._v("Converts this QueueRunner to a QueueRunnerDef protocol buffer.")]),e._v(" "),r("h4",{attrs:{id:"args-3"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#args-3","aria-hidden":"true"}},[e._v("#")]),e._v(" Args:")]),e._v(" "),r("ul",[r("li",[r("code",[e._v("export_scope")]),e._v(": Optional "),r("code",[e._v("string")]),e._v(". Name scope to remove.")])]),e._v(" "),r("h4",{attrs:{id:"returns-3"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#returns-3","aria-hidden":"true"}},[e._v("#")]),e._v(" Returns:")]),e._v(" "),r("p",[e._v("A QueueRunnerDef protocol buffer, or None if the Variable is not in the specified name scope.")])])}),[],!1,null,null,null);t.default=o.exports}}]);